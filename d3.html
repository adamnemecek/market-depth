<html>
<head>
    <title>Bitcoin Market Depth</title>
    <script type="text/javascript" src="d3.v3.min.js"></script>
    <style type="text/css">
        .axis path,
        .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }

        .axis text {
            font-family: sans-serif;
            font-size: 11px;
        }

        .ask {
            fill: red;
        }

        .bid {
            fill: green;
        }

    </style>
</head>
<body>
<script type="text/javascript">

    var w = 800;
    var h = 300;
    var padding = 40;

    var data = { asks: [
        [ 660.008, 0.11452179 ],
        [ 660.419, 0.0499 ],
        [ 660.42, 0.31980426 ],
        [ 660.858, 2.75044577 ],
        [ 660.999, 0.01995083 ],
        [ 661, 0.57335682 ],
        [ 661.01, 0.0604168 ],
        [ 661.39, 1.60922866 ],
        [ 661.6, 0.02640682 ],
        [ 661.7, 0.0918 ],
        [ 661.71, 0.02629704 ],
        [ 661.97, 0.06573262 ],
        [ 661.997, 0.02629704 ],
        [ 662, 0.02629704 ],
        [ 662.111, 5.45302279 ],
        [ 662.15, 11 ],
        [ 663, 0.019 ],
        [ 663.304, 0.024 ],
        [ 663.997, 0.7 ],
        [ 664.13, 1.3863669 ],
        [ 664.225, 0.07429335 ],
        [ 664.355, 0.024 ],
        [ 664.847, 14.3 ],
        [ 664.848, 6.17614411 ],
        [ 664.9, 1.02 ],
        [ 665, 9.40610521 ],
        [ 665.062, 0.02 ],
        [ 665.254, 0.02 ],
        [ 665.407, 0.024 ],
        [ 665.5, 0.21872231 ],
        [ 665.689, 0.10395441 ],
        [ 665.69, 0.72632698 ],
        [ 665.696, 0.02634694 ],
        [ 665.698, 0.01317347 ],
        [ 665.699, 0.03961023 ],
        [ 665.7, 0.03640376 ],
        [ 665.71, 1 ],
        [ 665.87, 0.09616361 ],
        [ 665.888, 0.10602752 ],
        [ 665.899, 14.3 ],
        [ 665.9, 14.97 ],
        [ 665.904, 6.93652083 ],
        [ 666, 0.0153 ],
        [ 666.278, 0.01320341 ],
        [ 666.461, 0.024 ],
        [ 666.533, 0.02633696 ],
        [ 666.6, 0.5 ],
        [ 666.799, 1.5 ],
        [ 666.87, 5 ],
        [ 666.9, 0.05 ],
        [ 666.96, 0.1 ],
        [ 666.966, 0.2 ],
        [ 666.98, 3.16 ],
        [ 666.998, 0.707582 ],
        [ 666.999, 7.15 ],
        [ 667, 69.77811712 ],
        [ 667.102, 0.012 ],
        [ 667.517, 0.024 ],
        [ 667.69, 0.0131585 ],
        [ 667.74, 1.82192255 ],
        [ 667.8, 0.0252565 ],
        [ 667.88, 0.1320664 ],
        [ 667.89, 0.9999 ],
        [ 667.9, 0.1 ],
        [ 667.956, 0.01 ],
        [ 668, 4.732712 ],
        [ 668.011, 0.1442 ],
        [ 668.495, 4.32080644 ],
        [ 668.496, 2.151 ],
        [ 668.498, 0.0131585 ],
        [ 668.574, 0.024 ],
        [ 668.817, 0.01 ],
        [ 668.9, 5.4099024 ],
        [ 668.999, 1 ],
        [ 669, 4.05340797 ],
        [ 669.101, 0.016 ],
        [ 669.102, 0.11490001 ],
        [ 669.113, 0.01177421 ],
        [ 669.2, 0.2397731 ],
        [ 669.233, 1.6 ],
        [ 669.312, 0.01 ],
        [ 669.36, 0.0998 ],
        [ 669.399, 0.02 ],
        [ 669.633, 0.015 ],
        [ 669.67, 0.05 ],
        [ 669.699, 21.45 ],
        [ 669.7, 10.07980001 ],
        [ 669.95, 0.1595 ],
        [ 669.96, 0.5 ],
        [ 669.966, 0.224 ],
        [ 669.97, 0.0529402 ],
        [ 669.989, 0.11189257 ],
        [ 669.99, 3.945553 ],
        [ 669.999, 0.02220467 ],
        [ 670, 72.51201839 ],
        [ 670.01, 0.0727 ],
        [ 670.133, 0.17290534 ],
        [ 670.215, 0.2596 ],
        [ 670.3, 0.05711684 ],
        [ 670.458, 4.99 ]
    ], bids: [
        [ 658, 0.8910736 ],
        [ 657.5, 2.5 ],
        [ 657.2, 1.87478222 ],
        [ 656.748, 0.016 ],
        [ 656.746, 0.1677 ],
        [ 656.55, 0.91794018 ],
        [ 656.2, 0.2 ],
        [ 656.1, 0.1004629 ],
        [ 656, 1.23860763 ],
        [ 655.704, 0.024 ],
        [ 655.259, 0.01 ],
        [ 655.002, 6.10685158 ],
        [ 655.001, 0.36 ],
        [ 655, 7.17601422 ],
        [ 654.737, 0.02 ],
        [ 654.669, 0.016 ],
        [ 654.5, 0.612 ],
        [ 654.01, 0.05066222 ],
        [ 653.639, 0.01003 ],
        [ 653.636, 0.02662049 ],
        [ 653.635, 0.024 ],
        [ 653.258, 1.65192652 ],
        [ 653.2, 0.38697146 ],
        [ 653, 8.61481576 ],
        [ 652.999, 0.05 ],
        [ 652.91, 0.02 ],
        [ 652.603, 0.024 ],
        [ 652.4, 0.010021 ],
        [ 652.38, 0.01 ],
        [ 652.29, 1.30663417 ],
        [ 652.285, 21.59271863 ],
        [ 652.284, 15 ],
        [ 652.234, 0.11942307 ],
        [ 652.11, 15 ],
        [ 652.1, 3.80864646 ],
        [ 652, 3.1 ],
        [ 651.793, 0.02 ],
        [ 651.573, 0.024 ],
        [ 651.2, 16.314436 ],
        [ 651.1, 0.1 ],
        [ 651, 3.714 ],
        [ 650.544, 0.024 ],
        [ 650.2, 0.102 ],
        [ 650.177, 0.01077633 ],
        [ 650.11, 2.77 ],
        [ 650.1, 0.17400681 ],
        [ 650.002, 0.10795427 ],
        [ 650, 19.42562529 ],
        [ 649.749, 0.63148889 ],
        [ 649.517, 0.026 ],
        [ 649.421, 0.7817921 ],
        [ 649.07, 2 ],
        [ 649.017, 0.35695086 ],
        [ 648.979, 0.01098 ],
        [ 648.651, 0.01 ],
        [ 648.624, 0.02 ],
        [ 648.414, 0.01 ],
        [ 648, 0.03417662 ],
        [ 647.978, 0.016 ],
        [ 647.96, 0.014532 ],
        [ 647.588, 0.02 ],
        [ 647.5, 2 ],
        [ 647.4, 2 ],
        [ 647.399, 0.01398 ],
        [ 647.313, 0.012 ],
        [ 647.3, 2 ],
        [ 647.13, 0.01198 ],
        [ 647.1, 1.03192925 ],
        [ 647.013, 0.02582357 ],
        [ 647, 2.51753184 ],
        [ 646.5, 2 ],
        [ 646.214, 0.012 ],
        [ 646.211, 2.6 ],
        [ 646.1, 0.32384484 ],
        [ 646.056, 0.01 ],
        [ 646, 0.35301733 ],
        [ 645.676, 2.6 ],
        [ 645.533, 0.0183 ],
        [ 645.5, 9.2750318 ],
        [ 645.116, 0.027 ],
        [ 645.1, 0.06053262 ],
        [ 645.01, 0.03 ],
        [ 645.001, 0.19928718 ],
        [ 645, 2.91930884 ],
        [ 644.8, 0.5 ],
        [ 644.785, 0.02798 ],
        [ 644.772, 0.1 ],
        [ 644.736, 0.013913 ],
        [ 644.014, 0.06 ],
        [ 644, 0.88062267 ],
        [ 643.743, 0.53308068 ],
        [ 643.693, 0.02 ],
        [ 643.607, 0.35 ],
        [ 643.5, 0.39 ],
        [ 643.472, 0.01 ],
        [ 643.4, 1.342 ],
        [ 643, 2.21348572 ],
        [ 642.96, 0.01598 ],
        [ 642.852, 0.014 ],
        [ 642.604, 0.1 ]
    ] }

function visualise(data){

    var asks = data.asks;
    var bids = data.bids;


    var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);


    var asksMin = d3.min(asks, function (d) {
        return d[0];
    });

    var bidsMin = d3.min(bids, function (d) {
        return d[0];
    });
    var asksMax = d3.max(asks, function (d) {
        return d[0];
    });
    var bidsMax = d3.max(asks, function (d) {
        return d[0];
    });

    var min = d3.min([asksMin, bidsMin]);
    var max = d3.min([asksMax, bidsMax]);
    var domainArray = [ min, max ];

    var xScale = d3.scale.linear()
            .domain(domainArray)
            .range([padding, w - padding]);

    var yScale = d3.scale.linear()
            .domain([0, d3.sum(asks, function (d) {
                return d[1];
            })])
            .range([h - padding, padding]);

    svg.selectAll("circle")
            .data(asks)
            .enter()
            .append("circle")
            .attr("cx", function (d) {
                return xScale(d[0]);
            })
            .attr("cy", function (d, i) {
                var iterData = asks.slice(0, i);
                var sum = d3.sum(iterData, function (d) {
                    return d[1];
                })
                return yScale(sum);
            })
            .attr("r", 2)
            .attr('class', 'ask');

    svg.selectAll("rect")
            .data(bids)
            .enter()
            .append("rect")

            .attr("x", function (d) {
                return xScale(d[0]);
            })
            .attr("y", function (d, i) {
                var iterData = asks.slice(0, i);
                var sum = d3.sum(iterData, function (d) {
                    return d[1];
                })
                return yScale(sum);
            })
            .attr("width", 3)
            .attr("height", 3)
            .attr('class', 'bid');

    var xAxis = d3.svg.axis()
            .scale(xScale)
            .orient("bottom")
            .ticks(10);  //Set rough # of ticks


    svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(0," + (h - padding) + ")")
            .call(xAxis);


    var yAxis = d3.svg.axis()
            .scale(yScale)
            .orient("left")
            .ticks(10);

    svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + padding + ",0)")
            .call(yAxis);

}


visualise(data);

</script>
</body>
</html>


